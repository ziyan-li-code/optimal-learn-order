# Continual Learning Experiment Configuration (Accuracy)

This repository is designed for evaluating the performance of models in **continual learning scenarios**, focusing on the **accuracy** across multiple sequential tasks. It includes tools to calculate both average and optimal accuracy metrics.

## Purpose
The primary goal of this repository is to:
- Train a model sequentially across a series of tasks.
- Measure the average accuracy for different task permutations.
- Identify the optimal accuracies in continual learning with two models: max hamiltonian path and periphery-to-core order.

## Core Scripts
### `acc_avg.py`
This script calculates the **average accuracy** over a specific number of task permutations in the continual learning scenario. 
- **Purpose**: To evaluate the overall model performance when task order is varied.
- **How it works**: 
  - The script generates multiple permutations of task orders.
  - For each permutation, it computes the average accuracy of all tasks with the final model after continual learning.
  - The results are aggregated to produce the average accuracy for multiple permutations.

### `acc_optimal.py`
This script calculates the **optimal accuracy** achieved by the two models when tasks are presented in optimal order with max hamiltonian path and periphery-to-core order.
- **Purpose**: To determine the maximum achievable performance with an ideal task sequence.
- **How it works**:
  - The script extract average accuracies and selected tasks labels from the **csv** file generated by **`acc_avg.py`**.
  - It uses the zero-shot model to evaluate the inter-task similarity matrix, which helps define the optimal task order with max hamiltonian path/periphery-to-core sequence.
  - The result reflects the optimal model performance in a continual learning setup.

## Parameters for Configuration
### Model Selection
- **`ds_type`**: Dataset type. Options include:
  - `'fashion_mnist'`: Grayscale dataset.
  - `'cifar10'`: Colored dataset with 10 classes.
  - `'cifar100'`: Colored dataset with 100 classes.
- **`nn_type`**: Neural network architecture type. Options include:
  - `'cnn2'`, `'cnn5'`: Convolutional neural networks for binary and five-class classification.
  - `'nonlinear2'`, `'nonlinear5'`: Nonlinear models for binary and five-class classification.
- **`sim_type`**: Similarity calculation model type:
  - `'zero_shot'`: Zero-shot learning evaluation.
  - `'-ghg'`: negative Gradient-based similarity analysis.
- **`ghg_batch_size`**: Batch size used for calculating task similarity when `sim_type` is set to `'-ghg'` (default: 256).


### Training Process
- **`num_task`**: Total number of tasks in the continual learning setup (e.g., 5).
- **`num_output_classes`**: Number of output classes per task (e.g., 2).
- **`num_all_classes`**: Total number of classes in the dataset (e.g., 10 for CIFAR-10).
- **`learning_rate`**: Learning rate for optimization (e.g., 0.001).
- **`num_regular_epochs`**: Number of epochs per task during the regular training phase (e.g., 5).
- **`num_continue_epochs`**: Number of epochs during the continued training phase (e.g., 5).
- **`batch_size`**: Batch size for training (e.g., 4).
- **`shuffle_size`**: Shuffle buffer size for data loading (e.g., 1000).
- **`image_size`**: Input image dimensions:
  - `[28, 28, 1]` for grayscale datasets.
  - `[32, 32, 3]` for colored datasets.

### Experiment Settings
- **`num_pick`**: Number of ways to randomly pick and group `num_task * num_class` classes (e.g., 10).
- **`num_perm`**: Number of multi-permutations for each sample point (e.g., 6, 30, or 50 for P = 3, 5, or 7).
- **`num_index`**: Job index for managing class splits and label splits.
- **`ini_seed`**: Seed for initializing model parameters to ensure reproducibility.

## How to Use the Scripts
1. **Calculate Average Accuracy**:
   - Run `acc_avg.py` to compute the average accuracy over a specific number of possible task orders.
   - Example:
     ```bash
     python3 acc_avg.py
     ```
2. **Calculate Optimal Accuracy**:
   - Run `acc_optimal.py` to find the task order yielding the high accuracy.
   - Example:
     ```bash
     python3 acc_optimal.py
     ```

## Output
- **`acc_avg.py`**: Produces a  **csv** file storing a summary of average accuracy across task permutations and the selected task labels in continual learning.
- **`acc_optimal.py`**: Extract average accuracies and task labels from  **csv** file, then outputs the optimal accuracies with max hamiltonian path and periphery-to-core sequence.

These scripts provide comprehensive insights into model performance in continual learning settings. Feel free to modify the parameters for your specific experimental requirements.
